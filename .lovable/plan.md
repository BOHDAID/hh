
# Ø®Ø·Ø©: Ø¥ØµÙ„Ø§Ø­ Ù†Ø¸Ø§Ù… OSN Ø§Ù„Ø¢Ù„ÙŠ (Email + OTP Ø¨Ø¯ÙˆÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±)

## ÙÙ‡Ù… Ø§Ù„Ù…Ø´ÙƒÙ„Ø©

Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠÙØªØ±Ø¶ Ø®Ø·Ø£Ù‹ Ø£Ù† OSN ÙŠØ­ØªØ§Ø¬:
- Email + Password â† **Ø®Ø·Ø£!**

Ø§Ù„ÙˆØ§Ù‚Ø¹ Ø£Ù† OSN ÙŠØ¹Ù…Ù„ Ù‡ÙƒØ°Ø§:
- Email ÙÙ‚Ø· â†’ OSN ÙŠØ±Ø³Ù„ OTP Ù„Ù„Ù€ Email â†’ Ø¥Ø¯Ø®Ø§Ù„ OTP â†’ ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„

---

## Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„ØµØ­ÙŠØ­

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù€ OSN                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“Œ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†ØªØ¬ (ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…):                              â”‚
â”‚     â”œâ”€ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù†ØªØ¬: OSN                                       â”‚
â”‚     â”œâ”€ Gmail Address: example@gmail.com (Ø­Ø³Ø§Ø¨ OSN)             â”‚
â”‚     â”œâ”€ Gmail App Password: xxxx xxxx xxxx xxxx (Ù„Ù‚Ø±Ø§Ø¡Ø© IMAP)   â”‚
â”‚     â””â”€ Ù†ÙˆØ¹ Ø§Ù„ØªÙØ¹ÙŠÙ„: QR Ø£Ùˆ OTP                                  â”‚
â”‚                                                                 â”‚
â”‚  ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ± (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©):                                  â”‚
â”‚     â”œâ”€ Ø§Ù„Ù…ØªØµÙØ­ ÙŠÙØªØ­ https://stream.osn.com/login               â”‚
â”‚     â”œâ”€ ÙŠØ¯Ø®Ù„ Email ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† password!)                         â”‚
â”‚     â”œâ”€ ÙŠØ¶ØºØ· "Continue" Ø£Ùˆ "Next"                               â”‚
â”‚     â”œâ”€ OSN ÙŠØ±Ø³Ù„ OTP Ø¥Ù„Ù‰ Gmail                                  â”‚
â”‚     â”œâ”€ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠÙ‚Ø±Ø£ OTP Ù…Ù† Gmail Ø¹Ø¨Ø± IMAP                       â”‚
â”‚     â”œâ”€ ÙŠØ¯Ø®Ù„ OTP â† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­                              â”‚
â”‚     â””â”€ Ø§Ù„Ø¬Ù„Ø³Ø© ØªØ¨Ù‚Ù‰ Ù…ÙØªÙˆØ­Ø© ÙˆØ¬Ø§Ù‡Ø²Ø© âœ…                             â”‚
â”‚                                                                 â”‚
â”‚  ğŸ‘¤ Ø¹Ù…ÙŠÙ„ ÙŠØ´ØªØ±ÙŠ ÙˆÙŠØ±Ø³Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„:                              â”‚
â”‚     â”œâ”€ Ø¥Ø°Ø§ QR: Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¬Ù„Ø¨ QR Ù…Ù† ØµÙØ­Ø© Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø§Ø²              â”‚
â”‚     â””â”€ Ø¥Ø°Ø§ OTP: Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠÙ‚Ø±Ø£ Ø¢Ø®Ø± OTP Ù…Ù† Gmail ÙˆÙŠØ±Ø³Ù„Ù‡           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

### 1. ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ otp_configurations

Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù„ØªÙˆØ¶ÙŠØ­ Ø§Ù„ØºØ±Ø¶:

| Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ | Ø§Ù„Ù…Ù‚ØªØ±Ø­ | Ø§Ù„Ø´Ø±Ø­ |
|-------------|---------|-------|
| gmail_address | osn_email | Ø¥ÙŠÙ…ÙŠÙ„ Ø­Ø³Ø§Ø¨ OSN |
| gmail_app_password | gmail_imap_password | App Password Ù„Ù‚Ø±Ø§Ø¡Ø© OTP Ù…Ù† Gmail |

**Ù…Ù„Ø§Ø­Ø¸Ø©:** ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ø¹ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ³Ù…ÙŠØ§Øª ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙ‚Ø·.

### 2. Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø¯Ù…Ø© Ù‚Ø±Ø§Ø¡Ø© Gmail (IMAP)

Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯: `src/services/gmail-reader.js`

```javascript
import Imap from 'imap';
import { simpleParser } from 'mailparser';

class GmailReader {
  constructor(email, appPassword) {
    this.config = {
      user: email,
      password: appPassword,
      host: 'imap.gmail.com',
      port: 993,
      tls: true,
    };
  }

  async getLatestOTP(maxAgeMinutes = 5) {
    // Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Gmail Ø¹Ø¨Ø± IMAP
    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¢Ø®Ø± 5 Ø¯Ù‚Ø§Ø¦Ù‚
    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ù…Ø² OTP (4-8 Ø£Ø±Ù‚Ø§Ù…)
  }
}
```

### 3. ØªØ­Ø¯ÙŠØ« Ø®Ø¯Ù…Ø© OSN Automation

Ù…Ù„Ù: `src/services/osn-automation.js`

**Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª:**
- Ø¥Ø²Ø§Ù„Ø© Ø­Ù‚Ù„ password Ù…Ù† Ø§Ù„Ø¯Ø§Ù„Ø©
- ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ¯ÙÙ‚ Ù„ÙŠÙƒÙˆÙ†: Email â†’ Ø§Ù†ØªØ¸Ø§Ø± â†’ Ù‚Ø±Ø§Ø¡Ø© OTP â†’ Ø¥Ø¯Ø®Ø§Ù„Ù‡

```javascript
async loginWithEmailOTP(email, gmailReader) {
  // 1. ÙØªØ­ ØµÙØ­Ø© OSN
  // 2. Ø¥Ø¯Ø®Ø§Ù„ Email ÙÙ‚Ø·
  // 3. Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Continue
  // 4. Ø§Ù†ØªØ¸Ø§Ø± 5 Ø«ÙˆØ§Ù†ÙŠ Ù„ÙŠØµÙ„ OTP
  // 5. Ù‚Ø±Ø§Ø¡Ø© OTP Ù…Ù† Gmail
  // 6. Ø¥Ø¯Ø®Ø§Ù„ OTP
  // 7. ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„
}
```

### 4. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø©

Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯: `src/services/session-manager.js`

```javascript
class OSNSessionManager {
  constructor() {
    this.browser = null;
    this.page = null;
    this.isLoggedIn = false;
    this.gmailReader = null;
  }

  // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„Ø³ÙŠØ±ÙØ±
  async initialize(email, gmailAppPassword) {
    this.gmailReader = new GmailReader(email, gmailAppPassword);
    await this.login(email);
  }

  // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Email + OTP
  async login(email) {
    // ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­
    // Ø¥Ø¯Ø®Ø§Ù„ email
    // Ø§Ù†ØªØ¸Ø§Ø± OTP
    // Ù‚Ø±Ø§Ø¡Ø© OTP Ù…Ù† Gmail
    // Ø¥Ø¯Ø®Ø§Ù„Ù‡
    // Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù„Ø³Ø© Ù…ÙØªÙˆØ­Ø©
  }

  // Ø¬Ù„Ø¨ QR Ù„Ù„Ø¹Ù…ÙŠÙ„
  async getQRCode() {
    // Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„ØµÙØ­Ø© Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø§Ø²
    // Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© QR
  }

  // Ø¬Ù„Ø¨ OTP Ù„Ù„Ø¹Ù…ÙŠÙ„
  async getClientOTP() {
    // Ù‚Ø±Ø§Ø¡Ø© Ø¢Ø®Ø± OTP Ù…Ù† Gmail
  }
}
```

### 5. ØªØ­Ø¯ÙŠØ« server.js

Ø¥Ø¶Ø§ÙØ© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„Ø³ÙŠØ±ÙØ±:

```javascript
import sessionManager from './src/services/session-manager.js';

// Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„Ø³ÙŠØ±ÙØ±
app.listen(PORT, async () => {
  console.log('ğŸš€ Server starting...');
  
  // ØªÙ‡ÙŠØ¦Ø© Ø¬Ù„Ø³Ø© OSN
  const osnEmail = process.env.OSN_EMAIL;
  const gmailPassword = process.env.GMAIL_APP_PASSWORD;
  
  if (osnEmail && gmailPassword) {
    await sessionManager.initialize(osnEmail, gmailPassword);
    console.log('âœ… OSN session initialized');
  }
});
```

### 6. ØªØ­Ø¯ÙŠØ« API Routes

Ù…Ù„Ù: `src/routes/qr-automation.js`

```javascript
// Ø¬Ù„Ø¨ QR (Ù„Ù„ØªÙØ¹ÙŠÙ„ Ø¹Ù„Ù‰ TV)
router.post('/get-qr', async (req, res) => {
  const qrImage = await sessionManager.getQRCode();
  res.json({ success: true, qrImage });
});

// Ø¬Ù„Ø¨ OTP (Ù„Ù„ØªÙØ¹ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„)
router.post('/get-otp', async (req, res) => {
  const otp = await sessionManager.getClientOTP();
  res.json({ success: true, otp });
});

// Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø³Ø©
router.get('/session-status', (req, res) => {
  res.json({ 
    loggedIn: sessionManager.isLoggedIn,
    email: sessionManager.currentEmail 
  });
});
```

### 7. ØªØ­Ø¯ÙŠØ« Ø¨ÙˆØª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…

ØªØ¹Ø¯ÙŠÙ„ Ø·Ø±ÙŠÙ‚Ø© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API:

```typescript
// Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„ email + password
// Ù†Ø³ØªØ¯Ø¹ÙŠ ÙÙ‚Ø· get-qr Ø£Ùˆ get-otp

if (activationType === "qr") {
  const result = await fetch(`${renderUrl}/api/qr/get-qr`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ secret }),
  });
  // Ø¥Ø±Ø³Ø§Ù„ QR Ù„Ù„Ø¹Ù…ÙŠÙ„
}

if (activationType === "otp") {
  const result = await fetch(`${renderUrl}/api/qr/get-otp`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ secret }),
  });
  // Ø¥Ø±Ø³Ø§Ù„ OTP Ù„Ù„Ø¹Ù…ÙŠÙ„
}
```

---

## Ø§Ù„Ø­Ø²Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

```json
{
  "imap": "^0.8.19",
  "mailparser": "^3.6.5"
}
```

---

## Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦ÙŠØ© (Environment Variables)

| Ø§Ù„Ù…ØªØºÙŠØ± | Ø§Ù„ÙˆØµÙ | Ø£ÙŠÙ† ÙŠÙØ³ØªØ®Ø¯Ù… |
|---------|-------|-------------|
| OSN_EMAIL | Ø¥ÙŠÙ…ÙŠÙ„ Ø­Ø³Ø§Ø¨ OSN | Ø®Ø§Ø¯Ù… Render |
| GMAIL_APP_PASSWORD | App Password Ù„Ù„Ù€ IMAP | Ø®Ø§Ø¯Ù… Render |
| QR_AUTOMATION_SECRET | Ù…ÙØªØ§Ø­ ØªØ£Ù…ÙŠÙ† API | Ø®Ø§Ø¯Ù… Render + Edge Function |
| RENDER_SERVER_URL | Ø±Ø§Ø¨Ø· Ø®Ø§Ø¯Ù… Render | Edge Function |

---

## Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù„ÙØ§Øª

| Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø­Ø§Ù„Ø© | Ø§Ù„ÙˆØµÙ |
|-------|--------|-------|
| src/services/gmail-reader.js | Ø¬Ø¯ÙŠØ¯ | Ù‚Ø±Ø§Ø¡Ø© OTP Ù…Ù† Gmail Ø¹Ø¨Ø± IMAP |
| src/services/session-manager.js | Ø¬Ø¯ÙŠØ¯ | Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù„Ø³Ø© OSN Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø© |
| src/services/osn-automation.js | ØªØ¹Ø¯ÙŠÙ„ | ØªØºÙŠÙŠØ± Ø§Ù„ØªØ¯ÙÙ‚ Ù„Ù€ Email + OTP |
| src/routes/qr-automation.js | ØªØ¹Ø¯ÙŠÙ„ | Ø¥Ø¶Ø§ÙØ© endpoints Ø¬Ø¯ÙŠØ¯Ø© |
| server.js | ØªØ¹Ø¯ÙŠÙ„ | ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡ |
| supabase/functions/telegram-bot-webhook/index.ts | ØªØ¹Ø¯ÙŠÙ„ | ØªØ­Ø¯ÙŠØ« Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª API |
| src/components/admin/OtpConfigurationsManager.tsx | ØªØ¹Ø¯ÙŠÙ„ | ØªÙˆØ¶ÙŠØ­ Ø§Ù„ØªØ³Ù…ÙŠØ§Øª |

---

## Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

1. **Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø©**: Ø¥Ø°Ø§ Ø£Ø¹Ø§Ø¯ Render ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±ØŒ ÙŠØ¬Ø¨ Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.

2. **Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬Ù„Ø³Ø©**: Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø© ÙƒÙ„ ÙØªØ±Ø©.

3. **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡**: Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø£Ø¯Ù…Ù† Ø¹Ø¨Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….

4. **ÙˆØ§Ø¬Ù‡Ø© OSN**: Ù‚Ø¯ ØªØªØºÙŠØ± Ø§Ù„Ø³ÙŠÙ„ÙƒØªÙˆØ±Ø§ØªØŒ ØªØ­ØªØ§Ø¬ ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ©.
